(self.webpackChunkapp_turns=self.webpackChunkapp_turns||[]).push([[310],{8310:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EmployeesModule:()=>A});var o=r(8583),s=r(665),i=r(8663),n=r(8259),a=r.n(n),m=r(639),c=r(4640),l=r(7556);let u=(()=>{class e{constructor(e,t){this.EmployeesService=e,this.authService=t,this.employees=[],this.employeePassword="",this.myForm=new s.cw({password:new s.NI,newPassword:new s.NI,confirmPassword:new s.NI})}ngOnInit(){this.authService.userToken().then(e=>this.employee=e)}onSubmit(){this.checkOldAndNewPassword()&&(this.EmployeesService.updatePassword(this.employee.name,this.myForm.value.newPassword).subscribe(),a().fire({icon:"success",title:"Contrase\xf1a cambiada con \xe9xito",timer:1500}))}checkOldAndNewPassword(){return null!=this.myForm.value.newPassword&&this.myForm.value.newPassword.trim().length>=6?this.myForm.value.newPassword==this.myForm.value.confirmPassword||(a().fire({icon:"error",title:"Las contrase\xf1as deben ser iguales",timer:1500}),!1):(a().fire({icon:"error",title:"La contrase\xf1a debe tener 6 d\xedgitos o m\xe1s",timer:1500}),!1)}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(c.M),m.Y36(l.e))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-change-password"]],decls:19,vars:1,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"row","mb-4"],["formControlName","newPassword","type","password",1,"form-control"],["formControlName","confirmPassword","type","password",1,"form-control"],[1,"row","text-center"],["type","submit",1,"btn","btn-warning"]],template:function(e,t){1&e&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"h2",3),m._uU(4,"Cambiar contrase\xf1a"),m.qZA(),m.qZA(),m.TgZ(5,"div",4),m.TgZ(6,"div",5),m.TgZ(7,"form",6),m.NdJ("ngSubmit",function(){return t.onSubmit()}),m.TgZ(8,"div",7),m.TgZ(9,"p"),m._uU(10,"Introduce nueva contrase\xf1a"),m.qZA(),m._UZ(11,"input",8),m.qZA(),m.TgZ(12,"div",7),m.TgZ(13,"p"),m._uU(14,"Confirma nueva contrase\xf1a"),m.qZA(),m._UZ(15,"input",9),m.qZA(),m.TgZ(16,"div",10),m.TgZ(17,"button",11),m._uU(18,"Modificar contrase\xf1a"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&e&&(m.xp6(7),m.Q6J("formGroup",t.myForm))},directives:[s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u],styles:[""]}),e})(),h=(()=>{class e{constructor(e){this.EmployeesService=e,this.employees=[],this.myForm=new s.cw({name:new s.NI,email:new s.NI,isABoss:new s.NI,password:new s.NI,confirmPassword:new s.NI})}ngOnInit(){this.timerSubscription=this.EmployeesService.getEmployees().subscribe(e=>this.employees=e)}ngOnDestroy(){this.timerSubscription.unsubscribe()}onSubmit(){if(this.checkName()&&this.checkEmail()&&this.checkIsABoss()&&this.checkPassword()){const{name:e,password:t,email:r,isABoss:o}=this.myForm.value;this.EmployeesService.createEmployee(e,t,r,o).subscribe(t=>{0==t.ok?a().fire({icon:"error",title:"El email no tiene un formato v\xe1lido",showConfirmButton:!0,timer:5e3}):a().fire({icon:"success",title:`\n              Usuario creado!!\n              Nombre: ${e},\n              Email: ${r}\n                `,showConfirmButton:!0,timer:5e3})})}}checkName(){return null!=this.myForm.value.name&&this.myForm.value.name.trim()?null==this.employees.find(e=>{var t;return e.name==(null===(t=this.myForm.get("name"))||void 0===t?void 0:t.value)})||(a().fire({icon:"error",title:`Ya existe empleado con nombre: ${this.myForm.value.name}`,timer:2e3}),!1):(a().fire({icon:"error",title:"El nombre no puede estar vac\xedo",timer:2e3}),!1)}checkEmail(){return null!=this.myForm.value.email&&this.myForm.value.email.trim()?null==this.employees.find(e=>{var t;return e.email==(null===(t=this.myForm.get("email"))||void 0===t?void 0:t.value)})||(a().fire({icon:"error",title:"Ya existe ese email",timer:2e3}),!1):(a().fire({icon:"error",title:"El email no puede estar vac\xedo",timer:2e3}),!1)}checkIsABoss(){return null!=this.myForm.value.isABoss||(a().fire({icon:"error",title:"El tipo de empleado no puede estar vac\xedo",timer:2e3}),!1)}checkPassword(){const e=this.myForm.value.password;return null!=this.myForm.value.password&&this.myForm.value.password.trim()&&e.length>=6?this.myForm.value.password===this.myForm.value.confirmPassword||(a().fire({icon:"error",title:"Las contrase\xf1as deben ser iguales",timer:2e3}),!1):(a().fire({icon:"error",title:"La contrase\xf1a debe tener como m\xednimo 6 caracteres",timer:2e3}),!1)}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(c.M))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-create-employee"]],decls:35,vars:1,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"row","mb-4"],["formControlName","name","type","text",1,"form-control"],["formControlName","email","type","email",1,"form-control"],["formControlName","isABoss",1,"form-select"],["value","false","selected",""],["value","true"],["formControlName","password","type","password",1,"form-control"],["formControlName","confirmPassword","type","password",1,"form-control"],[1,"row","text-center"],["type","submit",1,"btn","btn-warning"]],template:function(e,t){1&e&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"h2",3),m._uU(4,"Crear empleado"),m.qZA(),m.qZA(),m.TgZ(5,"div",4),m.TgZ(6,"div",5),m.TgZ(7,"form",6),m.NdJ("ngSubmit",function(){return t.onSubmit()}),m.TgZ(8,"div",7),m.TgZ(9,"p"),m._uU(10,"Introduce el nombre"),m.qZA(),m._UZ(11,"input",8),m.qZA(),m.TgZ(12,"div",7),m.TgZ(13,"p"),m._uU(14,"Introduce el email"),m.qZA(),m._UZ(15,"input",9),m.qZA(),m.TgZ(16,"div",7),m.TgZ(17,"p"),m._uU(18,"Tipo de empleado"),m.qZA(),m.TgZ(19,"select",10),m.TgZ(20,"option",11),m._uU(21,"Normal"),m.qZA(),m.TgZ(22,"option",12),m._uU(23,"Jefe"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(24,"div",7),m.TgZ(25,"p"),m._uU(26,"Introduce contrase\xf1a"),m.qZA(),m._UZ(27,"input",13),m.qZA(),m.TgZ(28,"div",7),m.TgZ(29,"p"),m._uU(30,"Repite la contrase\xf1a"),m.qZA(),m._UZ(31,"input",14),m.qZA(),m.TgZ(32,"div",15),m.TgZ(33,"button",16),m._uU(34,"Crear"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&e&&(m.xp6(7),m.Q6J("formGroup",t.myForm))},directives:[s._Y,s.JL,s.sg,s.Fj,s.JJ,s.u,s.EJ,s.YN,s.Kr],styles:[""]}),e})();function p(e,t){if(1&e&&(m.TgZ(0,"option",12),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.s9C("value",e.name),m.xp6(1),m.hij(" ",e.name,"")}}let d=(()=>{class e{constructor(e){this.employeesService=e,this.employees=[],this.myForm=new s.cw({name:new s.NI})}ngOnInit(){this.timerSubscription=this.employeesService.getEmployees().subscribe(e=>{this.employees=e})}ngOnDestroy(){this.timerSubscription.unsubscribe()}onSubmit(){if(null===this.myForm.value.name)return void a().fire({icon:"error",title:"El usuario introducido es incorrecto, por favor int\xe9ntalo de nuevo",showConfirmButton:!1,timer:1500});const e=a().mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});e.fire({title:"\xbfEst\xe1s seguro?",text:"Est\xe1s a punto de borrar un empleado",icon:"warning",showCancelButton:!0,confirmButtonText:"Borrar!",cancelButtonText:"Cancelar!",reverseButtons:!0}).then(t=>{t.isConfirmed?this.employeesService.deleteEmployee(this.myForm.value.name).subscribe(t=>{e.fire("Usuario Borrado con \xe9xito",`${this.myForm.value.name}`,"success")}):t.dismiss===a().DismissReason.cancel&&e.fire("Operaci\xf3n cancelada","No se realizar\xe1 ninguna operaci\xf3n","error")})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(c.M))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-delete-employee"]],decls:16,vars:2,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"row","mb-5"],["formControlName","name",1,"form-select"],["class","text-black",3,"value",4,"ngFor","ngForOf"],[1,"row","text-center"],["type","submit",1,"btn","btn-warning"],[1,"text-black",3,"value"]],template:function(e,t){1&e&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"h2",3),m._uU(4,"Eliminar empleado"),m.qZA(),m.qZA(),m.TgZ(5,"div",4),m.TgZ(6,"div",5),m.TgZ(7,"form",6),m.NdJ("ngSubmit",function(){return t.onSubmit()}),m.TgZ(8,"div",7),m.TgZ(9,"p"),m._uU(10,"Introduce el nombre del empleado que quieres eliminar"),m.qZA(),m.TgZ(11,"select",8),m.YNc(12,p,2,2,"option",9),m.qZA(),m.qZA(),m.TgZ(13,"div",10),m.TgZ(14,"button",11),m._uU(15,"Eliminar"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&e&&(m.xp6(7),m.Q6J("formGroup",t.myForm),m.xp6(5),m.Q6J("ngForOf",t.employees))},directives:[s._Y,s.JL,s.sg,s.EJ,s.JJ,s.u,o.sg,s.YN,s.Kr],styles:[""]}),e})();var f=r(9364),g=r(4832);function Z(e,t){if(1&e&&(m.TgZ(0,"option",13),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.s9C("value",e.name),m.xp6(1),m.hij(" ",e.name,"")}}function v(e,t){if(1&e&&(m.TgZ(0,"li",17),m._uU(1),m.qZA()),2&e){const e=t.$implicit;m.xp6(1),m.lnq(" Desde ",e.from," hasta ",e.to," tiene ",e.nightHours," horas nocturnas. ")}}function b(e,t){if(1&e&&(m.TgZ(0,"div",14),m.TgZ(1,"ul",15),m.YNc(2,v,2,3,"li",16),m.qZA(),m.qZA()),2&e){const e=m.oxw();m.xp6(2),m.Q6J("ngForOf",e.schedules)}}const y=[{path:"",children:[{path:"createEmployee",component:h},{path:"deleteEmployee",component:d},{path:"changePassword",component:u},{path:"nightHours",component:(()=>{class e{constructor(e,t,r){this.employeesService=e,this.scheduleService=t,this.shiftService=r,this.employees=[],this.schedules=[],this.shifts=[],this.hasSchedules=!1,this.myForm=new s.cw({name:new s.NI})}ngOnInit(){this.employeesService.getEmployees().subscribe(e=>{this.employees=e})}onSubmit(){const e=this.myForm.value.name;this.schedules=[],null!==e?(this.shiftService.allShifts().subscribe(e=>{this.shifts=e,console.log(e)}),this.scheduleService.getScheduleByEmployeeName(e).subscribe(e=>{e.length>0?(this.hasSchedules=!0,e.forEach(e=>{let t=0;e.shifts.forEach(e=>{this.shifts.forEach(r=>{r.name==e&&(t+=r.nightHours)})}),this.schedules.push({from:e.dates[0],to:e.dates[e.dates.length-1],nightHours:t})}),console.log(this.schedules)):a().fire({icon:"error",title:"El empleado introducido no tiene ning\xfan calendario",showConfirmButton:!1,timer:1500})})):a().fire({icon:"error",title:"El usuario introducido es incorrecto, por favor int\xe9ntalo de nuevo",showConfirmButton:!1,timer:1500})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(c.M),m.Y36(f.u),m.Y36(g.U))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-night-hours"]],decls:17,vars:3,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"row","mb-5"],["formControlName","name",1,"form-select"],["class","text-black",3,"value",4,"ngFor","ngForOf"],[1,"row","text-center"],["type","submit",1,"btn","btn-warning"],["class","row mt-3",4,"ngIf"],[1,"text-black",3,"value"],[1,"row","mt-3"],[1,"list-group"],["class","list-group-item mb-1 bg-secondary",4,"ngFor","ngForOf"],[1,"list-group-item","mb-1","bg-secondary"]],template:function(e,t){1&e&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"h2",3),m._uU(4,"Horas nocturnas"),m.qZA(),m.qZA(),m.TgZ(5,"div",4),m.TgZ(6,"div",5),m.TgZ(7,"form",6),m.NdJ("ngSubmit",function(){return t.onSubmit()}),m.TgZ(8,"div",7),m.TgZ(9,"p"),m._uU(10,"Nombre de empleado"),m.qZA(),m.TgZ(11,"select",8),m.YNc(12,Z,2,2,"option",9),m.qZA(),m.qZA(),m.TgZ(13,"div",10),m.TgZ(14,"button",11),m._uU(15,"Comprobar"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(16,b,3,1,"div",12),m.qZA(),m.qZA(),m.qZA()),2&e&&(m.xp6(7),m.Q6J("formGroup",t.myForm),m.xp6(5),m.Q6J("ngForOf",t.employees),m.xp6(4),m.Q6J("ngIf",t.hasSchedules))},directives:[s._Y,s.JL,s.sg,s.EJ,s.JJ,s.u,o.sg,o.O5,s.YN,s.Kr],encapsulation:2}),e})()},{path:"**",redirectTo:"createEmployee"}]}];let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[i.Bz.forChild(y)],i.Bz]}),e})(),A=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[o.ez,s.UX,w]]}),e})()},9364:(e,t,r)=>{"use strict";r.d(t,{u:()=>l});var o=r(3342),s=r(5304),i=r(5917),n=r(9019),a=r(639),m=r(1841),c=r(8663);let l=(()=>{class e{constructor(e,t){this.http=e,this.router=t,this.baseUrl=n.N.baseURL}getSchedules(){return this.http.get(`${this.baseUrl}/schedule`).pipe((0,o.b)(e=>e),(0,s.K)(e=>(0,i.of)(e)))}createSchedule(e,t,r,n,a){return this.http.post(`${this.baseUrl}/schedule/new`,{employeeName:e,dates:t,shifts:r,year:n,month:a}).pipe((0,o.b)(e=>e),(0,s.K)(e=>(0,i.of)(e)))}getScheduleByEmployeeName(e){return this.http.get(`${this.baseUrl}/schedule/scheduleByName/${e}`).pipe((0,o.b)(e=>e),(0,s.K)(e=>(0,i.of)(e)))}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(m.eN),a.LFG(c.F0))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},4832:(e,t,r)=>{"use strict";r.d(t,{U:()=>u});var o=r(5917),s=r(5304),i=r(8002),n=r(3342),a=r(9019),m=r(639),c=r(1841),l=r(8663);let u=(()=>{class e{constructor(e,t){this.http=e,this.router=t,this.baseUrl=a.N.baseURL}allShifts(){return this.http.get(`${this.baseUrl}/shift`).pipe((0,s.K)(e=>(0,o.of)(e.error)))}allShiftsNames(){let e=[];return this.http.get(`${this.baseUrl}/shift`).pipe((0,i.U)(t=>(t.forEach(t=>{e.push(t.name)}),e)),(0,s.K)(e=>(0,o.of)(e.error)))}createShift(e,t,r){return this.http.post(`${this.baseUrl}/shift`,{name:e,shift:t,nightHours:r}).pipe((0,n.b)(e=>this.router.navigateByUrl("/shifts/typesShifts")),(0,s.K)(e=>(0,o.of)(e.error)))}deleteShift(e){return this.http.delete(`${this.baseUrl}/shift/${e}`).pipe((0,n.b)(e=>this.router.navigateByUrl("/shifts/typesShift")),(0,s.K)(e=>(0,o.of)(e.error)))}}return e.\u0275fac=function(t){return new(t||e)(m.LFG(c.eN),m.LFG(l.F0))},e.\u0275prov=m.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);