(self.webpackChunkapp_turns=self.webpackChunkapp_turns||[]).push([[776],{1776:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ShiftManagementModule:()=>F});var r=i(8583),o=i(8663),n=i(665),s=i(8259),a=i.n(s),c=i(6738),u=i(639),m=i(4832),l=i(4640),f=i(9364);function h(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e," ")}}function d(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}function p(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}function Z(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}function g(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}function b(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}function y(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}function q(e,t){if(1&e&&(u.TgZ(0,"option",32),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.s9C("value",e),u.xp6(1),u.hij(" ",e,"")}}let v=(()=>{class e{constructor(e,t,i,r){this.shiftService=e,this.employeeService=t,this.scheduleService=i,this.fb=r,this.shiftsNames=[],this.employeeNames=[],this.myForm=this.fb.group({from:["",n.kI.required],employeeName:["",n.kI.required],mondayShift:["",n.kI.required],tuesdayShift:["",n.kI.required],wednesdayShift:["",n.kI.required],thursdayShift:["",n.kI.required],fridayShift:["",n.kI.required],saturdayShift:["",n.kI.required],sundayShift:["",n.kI.required]})}ngOnInit(){this.employeeService.getEmployeesNames().subscribe(e=>{this.employeeNames=e}),this.shiftService.allShiftsNames().subscribe(e=>{this.shiftsNames=e})}onSubmit(){const e=this.myForm.value.employeeName,t=this.myForm.value.from,i=this.myForm.value.mondayShift,r=this.myForm.value.tuesdayShift,o=this.myForm.value.wednesdayShift,n=this.myForm.value.thursdayShift,s=this.myForm.value.fridayShift,u=this.myForm.value.saturdayShift,m=this.myForm.value.sundayShift,l=t.split("-"),f=parseInt(l[2]),h=parseInt(l[0]),d=parseInt(l[1]),p=[];if(0===t.length)a().fire({icon:"error",title:"Por favor introduce fecha",timer:2500});else if(0===e.length)a().fire({icon:"error",title:"Por favor introduce empleado",timer:2500});else if(0===i.length||0===r.length||0===o.length||0===n.length||0===s.length||0===u.length||0===m.length)a().fire({icon:"error",title:"Por favor introduce turnos",timer:2500});else{let t=c(`${h}-${d}-${f}`,"YYYY-MM-DD");console.log(t);for(let e=0;e<7;e++)p.push(t.format("DD/MM")),t.add(1,"d");this.scheduleService.createSchedule(e,p,[i,r,o,n,s,u,m],l[0],l[1]).subscribe(e=>{1==e.ok?a().fire({icon:"success",title:"Calendario creado con \xe9xito",timer:2500}):a().fire({icon:"error",title:"No se puede crear un calendario con fecha anterior a la fecha actual",timer:2500})})}}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(m.U),u.Y36(l.M),u.Y36(f.u),u.Y36(n.qu))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-schedule-create"]],decls:67,vars:9,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header","pt-3"],[1,"text-center"],[1,"card-body","mb-5"],[3,"formGroup","ngSubmit"],[1,"row","mb-4"],[1,"row"],[1,"col-12"],["for","from"],["formControlName","from","type","date","id","from",1,"form-control"],[1,"row","mb-4","mt-3"],["for","employeeName"],["id","employeeName","formControlName","employeeName",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"my-5"],[1,"col-12","mb-3"],["for","mondayShift"],["formControlName","mondayShift","id","mondayShift",1,"form-select"],["for","tuesdayShift"],["formControlName","tuesdayShift","id","tuesdayShift",1,"form-select"],["for","wednesdayShift"],["formControlName","wednesdayShift","id","wednesdayShift",1,"form-select"],["for","thursdayShift"],["formControlName","thursdayShift","id","thursdayShift",1,"form-select"],["for","fridayShift"],["formControlName","fridayShift","id","fridayShift",1,"form-select"],["for","saturdayShift"],["formControlName","saturdayShift","id","saturdayShift",1,"form-select"],["for","sundayShift"],["formControlName","sundayShift","id","sundayShift",1,"form-select"],["type","submit","value","Crear",1,"btn","btn-warning","my-3","col-5","ms-2"],[3,"value"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h2",3),u._uU(4,"Crear calendario semanal"),u.qZA(),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"form",5),u.NdJ("ngSubmit",function(){return t.onSubmit()}),u.TgZ(7,"div",6),u.TgZ(8,"div",7),u.TgZ(9,"div",8),u.TgZ(10,"label",9),u._uU(11,"Desde: "),u.qZA(),u._UZ(12,"input",10),u.qZA(),u.qZA(),u.qZA(),u.TgZ(13,"div",11),u.TgZ(14,"div",8),u.TgZ(15,"label",12),u._uU(16,"Nombre: "),u.qZA(),u.TgZ(17,"select",13),u._UZ(18,"option"),u.YNc(19,h,2,2,"option",14),u.qZA(),u.qZA(),u.qZA(),u._UZ(20,"hr",15),u.TgZ(21,"h4",3),u._uU(22,"Turnos"),u.qZA(),u.TgZ(23,"div",11),u.TgZ(24,"div",16),u.TgZ(25,"label",17),u._uU(26,"Lunes"),u.qZA(),u.TgZ(27,"select",18),u._UZ(28,"option"),u.YNc(29,d,2,2,"option",14),u.qZA(),u.qZA(),u.TgZ(30,"div",16),u.TgZ(31,"label",19),u._uU(32,"Martes"),u.qZA(),u.TgZ(33,"select",20),u._UZ(34,"option"),u.YNc(35,p,2,2,"option",14),u.qZA(),u.qZA(),u.TgZ(36,"div",16),u.TgZ(37,"label",21),u._uU(38,"Mi\xe9rcoles"),u.qZA(),u.TgZ(39,"select",22),u._UZ(40,"option"),u.YNc(41,Z,2,2,"option",14),u.qZA(),u.qZA(),u.TgZ(42,"div",16),u.TgZ(43,"label",23),u._uU(44,"Jueves"),u.qZA(),u.TgZ(45,"select",24),u._UZ(46,"option"),u.YNc(47,g,2,2,"option",14),u.qZA(),u.qZA(),u.TgZ(48,"div",16),u.TgZ(49,"label",25),u._uU(50,"Viernes"),u.qZA(),u.TgZ(51,"select",26),u._UZ(52,"option"),u.YNc(53,b,2,2,"option",14),u.qZA(),u.qZA(),u.TgZ(54,"div",16),u.TgZ(55,"label",27),u._uU(56,"S\xe1bado"),u.qZA(),u.TgZ(57,"select",28),u._UZ(58,"option"),u.YNc(59,y,2,2,"option",14),u.qZA(),u.qZA(),u.TgZ(60,"div",16),u.TgZ(61,"label",29),u._uU(62,"Domingo"),u.qZA(),u.TgZ(63,"select",30),u._UZ(64,"option"),u.YNc(65,q,2,2,"option",14),u.qZA(),u.qZA(),u.qZA(),u._UZ(66,"input",31),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.xp6(6),u.Q6J("formGroup",t.myForm),u.xp6(13),u.Q6J("ngForOf",t.employeeNames),u.xp6(10),u.Q6J("ngForOf",t.shiftsNames),u.xp6(6),u.Q6J("ngForOf",t.shiftsNames),u.xp6(6),u.Q6J("ngForOf",t.shiftsNames),u.xp6(6),u.Q6J("ngForOf",t.shiftsNames),u.xp6(6),u.Q6J("ngForOf",t.shiftsNames),u.xp6(6),u.Q6J("ngForOf",t.shiftsNames),u.xp6(6),u.Q6J("ngForOf",t.shiftsNames))},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,n.EJ,n.YN,n.Kr,r.sg],styles:[""]}),e})();var A=i(6363),T=i(7556);function S(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h4",8),u._uU(2,"No hay cambios pendientes"),u.qZA(),u.qZA())}function N(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",10),u.TgZ(1,"h4",11),u._uU(2,"Solicitud de cambio"),u.qZA(),u._UZ(3,"hr"),u.TgZ(4,"p"),u._uU(5,"Empleados solicitantes del cambio: "),u.TgZ(6,"b"),u._uU(7),u.qZA(),u.qZA(),u.TgZ(8,"p"),u._uU(9,"Fecha del cambio: "),u.TgZ(10,"b"),u._uU(11),u.qZA(),u.qZA(),u.TgZ(12,"p"),u._uU(13,"Turnos antes del cambio: "),u._UZ(14,"br"),u.TgZ(15,"b"),u._uU(16),u.qZA(),u.qZA(),u.TgZ(17,"p"),u._uU(18,"Turnos despu\xe9s del cambio: "),u._UZ(19,"br"),u.TgZ(20,"b"),u._uU(21),u.qZA(),u.qZA(),u.TgZ(22,"p"),u.TgZ(23,"button",12),u.NdJ("click",function(){const t=u.CHM(e).$implicit;return u.oxw(2).acceptChange(t.id,t.applicantSchedule,t.affectedSchedule,t.index)}),u._uU(24," Aceptar "),u.qZA(),u.TgZ(25,"button",13),u.NdJ("click",function(){const t=u.CHM(e).$implicit;return u.oxw(2).declineChange(t._id)}),u._uU(26,"Rechazar"),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=t.$implicit;u.xp6(7),u.AsE("",e.applicantEmployeeName," - ",e.affectedEmployeeName,""),u.xp6(4),u.Oqu(e.changeDate),u.xp6(5),u.HOy(" ",e.applicantEmployeeName,": ",e.applicantShift," / ",e.affectedEmployeeName,": ",e.affectedShift," "),u.xp6(5),u.HOy(" ",e.applicantEmployeeName,": ",e.affectedShift," / ",e.affectedEmployeeName,": ",e.applicantShift," ")}}function _(e,t){if(1&e&&u.YNc(0,N,27,11,"div",9),2&e){const e=u.oxw();u.Q6J("ngForOf",e.changes)}}function U(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td"),u.TgZ(6,"button",8),u.NdJ("click",function(){const t=u.CHM(e).$implicit;return u.oxw().deleteShift(t._id)}),u._uU(7,"Eliminar"),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=t.$implicit;u.xp6(2),u.Oqu(e.name),u.xp6(2),u.Oqu(e.shift)}}const x=[{path:"",children:[{path:"shiftChanges",component:(()=>{class e{constructor(e,t){this.changesService=e,this.authService=t,this.isEmptyChanges=!0,this.changes=[],this.changesService.getChanges("accepted").subscribe(e=>{this.authService.userToken().then(t=>{for(let i of e)if(i.affectedEmployee===t.name){this.isEmptyChanges=!1;let t=i.shiftApplicant.dates.indexOf(i.changeDate);for(let i of e)this.changes.push({id:i._id,applicantEmployeeName:i.applicantEmployee,affectedEmployeeName:i.affectedEmployee,changeDate:i.changeDate,applicantShift:i.shiftApplicant.shifts[t],affectedShift:i.shiftAffected.shifts[t],applicantSchedule:i.shiftApplicant,affectedSchedule:i.shiftAffected,index:t})}})})}ngOnInit(){}acceptChange(e,t,i,r){this.changesService.updateChange(e,"approved",t,i,r).subscribe(),a().fire({icon:"success",title:"Cambio aceptado!!",timer:2e3})}declineChange(e){this.changesService.updateChange(e,"rejected").subscribe(),a().fire({icon:"error",title:"Cambio rechazado!!",timer:2e3})}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(A.p),u.Y36(T.e))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-shift-changes"]],decls:10,vars:2,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[4,"ngIf","ngIfElse"],["noEmpty",""],[1,"text-center","mt-5"],["class","bg-secondary border rounded m-auto",4,"ngFor","ngForOf"],[1,"bg-secondary","border","rounded","m-auto"],[1,"my-3"],[1,"btn","btn-warning","mx-3",3,"click"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){if(1&e&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h2",3),u._uU(4,"Gesti\xf3n de cambios de turno"),u.qZA(),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"div",5),u.YNc(7,S,3,0,"div",6),u.YNc(8,_,1,1,"ng-template",null,7,u.W1O),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e){const e=u.MAs(9);u.xp6(7),u.Q6J("ngIf",t.isEmptyChanges)("ngIfElse",e)}},directives:[r.O5,r.sg],styles:[""]}),e})()},{path:"shiftCreate",component:(()=>{class e{constructor(e){this.shiftService=e,this.mysShiftsList=[],this.myForm=new n.cw({name:new n.NI,shift:new n.NI,nightHours:new n.NI})}ngOnInit(){this.shiftService.allShifts().subscribe(e=>this.mysShiftsList=e)}onSubmit(){this.checkName()&&this.checkEmptyShift()&&this.checkEmptyNightHours()&&this.shiftService.createShift(this.myForm.value.name,this.myForm.value.shift,this.myForm.value.nightHours).subscribe(e=>0==e.ok?a().fire({icon:"error",title:e.msg,timer:1500}):a().fire({icon:"success",title:`Nuevo horario creado.\n                        Nombre: ${this.myForm.value.name}\n                        Horario: ${this.myForm.value.shift}`,timer:1500}))}checkName(){return null==this.myForm.value.name?(a().fire({icon:"error",title:"El campo nombre no puede estar vac\xedo",timer:1500}),!1):!!this.myForm.value.name.trim()||(a().fire({icon:"error",title:"El campo nombre no puede estar vac\xedo",timer:1500}),!1)}checkEmptyShift(){return null!=this.myForm.value.shift&&!!this.myForm.value.shift.trim()||(a().fire({icon:"error",title:"El horario no puede estar vac\xedo",timer:1500}),!1)}checkEmptyNightHours(){return null!=this.myForm.value.nightHours||(a().fire({icon:"error",title:"El n\xfamero de horas nocturnas no puede estar vac\xedo",timer:2e3}),!1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(m.U))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-shift-create"]],decls:23,vars:1,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"row","mb-4"],["formControlName","name","type","text",1,"form-control"],["formControlName","shift","type","text",1,"form-control"],["formControlName","nightHours","type","number","step","0.5",1,"form-control"],[1,"row","text-center"],["type","submit",1,"btn","btn-warning"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h2",3),u._uU(4,"Crear turno"),u.qZA(),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"div",5),u.TgZ(7,"form",6),u.NdJ("ngSubmit",function(){return t.onSubmit()}),u.TgZ(8,"div",7),u.TgZ(9,"p"),u._uU(10,"Introduce nombre"),u.qZA(),u._UZ(11,"input",8),u.qZA(),u.TgZ(12,"div",7),u.TgZ(13,"p"),u._uU(14,"Introduce horario"),u.qZA(),u._UZ(15,"input",9),u.qZA(),u.TgZ(16,"div",7),u.TgZ(17,"p"),u._uU(18,"Introduce n\xfamero de horas nocturnas"),u.qZA(),u._UZ(19,"input",10),u.qZA(),u.TgZ(20,"div",11),u.TgZ(21,"button",12),u._uU(22,"Crear"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.xp6(7),u.Q6J("formGroup",t.myForm))},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,n.wV],styles:[""]}),e})()},{path:"shiftDelete",component:(()=>{class e{constructor(e){this.ShiftsService=e}ngOnInit(){this.timerSubscription=this.ShiftsService.allShifts().subscribe(e=>{this.shiftsEnabled=e})}ngOnDestroy(){this.timerSubscription.unsubscribe()}deleteShift(e){const t=a().mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});t.fire({title:"\xbfEst\xe1s seguro?",text:"Est\xe1s a punto de borrar un turno",icon:"warning",showCancelButton:!0,confirmButtonText:"Borrar!",cancelButtonText:"Cancelar!",reverseButtons:!0}).then(i=>{i.isConfirmed?this.ShiftsService.deleteShift(e).subscribe(e=>{!0===e.ok?t.fire("Turno borrado con \xe9xito","Turno borrado","success"):t.fire("No se pudo borrar el turno, hable con el administrador","Turno borrado","error")}):i.dismiss===a().DismissReason.cancel&&t.fire("Operaci\xf3n cancelada","No se realizar\xe1 ninguna operaci\xf3n","error")})}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(m.U))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-shift-delete"]],decls:18,vars:1,consts:[[1,"row","bg-light","mx-3","rounded","mt-5"],[1,"card"],[1,"card-header"],[1,"text-center"],[1,"card-body","mb-5"],[1,"row"],[1,"table","table-bordered","text-center","m-auto","mb-3"],[4,"ngFor","ngForOf"],[1,"btn","btn-warning",3,"click"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u.TgZ(1,"div",1),u.TgZ(2,"div",2),u.TgZ(3,"h2",3),u._uU(4,"Eliminar turno"),u.qZA(),u.qZA(),u.TgZ(5,"div",4),u.TgZ(6,"div",5),u.TgZ(7,"table",6),u.TgZ(8,"thead"),u.TgZ(9,"tr"),u.TgZ(10,"th"),u._uU(11,"Nombre turno"),u.qZA(),u.TgZ(12,"th"),u._uU(13,"Horario"),u.qZA(),u.TgZ(14,"th"),u._uU(15,"Eliminar turno"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(16,"tbody"),u.YNc(17,U,8,2,"tr",7),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.xp6(17),u.Q6J("ngForOf",t.shiftsEnabled))},directives:[r.sg],styles:[""]}),e})()},{path:"scheduleCreate",component:v},{path:"**",redirectTo:"shiftChanges"}]}];let C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[o.Bz.forChild(x)],o.Bz]}),e})(),F=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.ez,n.UX,C]]}),e})()}}]);